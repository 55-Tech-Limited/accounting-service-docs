---
sidebar_label: "September 24, 2025"
description: "Major API documentation update implementing PR #35 with enhanced betting functionality, user management capabilities, portfolio-aware operations, and comprehensive exposure calculation algorithms."
---

# Change Log - September 24, 2025

## Summary

This represents a major documentation update implementing comprehensive changes from **PR #35**. The update includes significant enhancements to betting functionality, complete user management capabilities, exposure calculation algorithms, and the establishment of a formal change log system.

### Key Highlights
- ğŸ¯ **6 major commits** implementing new features and enhancements
- ğŸ“š **Multiple API endpoints** enhanced and documented across bet, user, and transaction systems
- ğŸ§® **Advanced exposure calculations** with aggregate portfolio-aware algorithms
- ğŸ—ï¸ **New documentation infrastructure** with change logs system
- ğŸ”§ **Atomic batch operations** (limited to 20 requests) with TypeScript definitions
- ğŸ›ï¸ **Enhanced filtering** capabilities for both bets and users with meta field support
- ğŸ“Š **Portfolio-aware operations** across all betting and outcome management endpoints
- ğŸ”§ **Comprehensive bug fixes** including transaction field cleanup and error handling improvements
- ğŸ§ª **Enhanced test coverage** ensuring reliability across all new features

## API Documentation Updates

### Bet Ledger API

#### Make Bet Offer Endpoint
- ğŸ’¥ **Breaking**: Removed `bet_id` field support (no longer accepted in requests)
- ğŸ’¥ **Breaking**: Made `wager_reference` field required instead of optional
- âœ¨ **New**: `allowed_acceptor_ids` field - array of user IDs allowed to accept the bet offer
- âœ¨ **New**: `allowed_acceptor_references` field - array of user references allowed to accept the bet offer
- ğŸ“ **Updated**: Documentation notes to explain allowed acceptor restrictions
- ğŸ“ **Updated**: All code examples (cURL, JavaScript, Python, Rust) to demonstrate both open and restricted bet offers

#### Open Bets Endpoint
- âœ¨ **New**: `allowed_acceptor_ids` field to response structure to match `GetOpenBetsResponseDto`
- ğŸ”§ **Enhanced**: Better test coverage for get-open-bets endpoint functionality
- ğŸ› **Fixed**: 500 error handling for `user_references` parameter

#### Batch Operations
- ğŸ”§ **Enhanced**: Comprehensive documentation for atomic batch operations
- âœ¨ **New**: Complete TypeScript type definitions for all 5 operation types
- ğŸ“ **Updated**: Examples showing atomic behavior (all-or-nothing execution)
- âš¡ **Performance**: Batch requests now limited to maximum 20 requests per batch

#### Cancel Bet Offer Endpoint
- ğŸ’¥ **Breaking**: `wager_reference` field replaced with `wager_references` array
- âœ¨ **New**: `wager_references` array support for canceling multiple offers
- âœ¨ **New**: `odds` filtering capability for selective cancellation
- ğŸ“ **Updated**: Response examples with enhanced functionality

#### Exposure Calculations
- âœ¨ **New**: Comprehensive guide at `/docs/guides/exposure-calculations`
- ğŸ“ **Updated**: `BetService.calculateExposure` algorithm with two-scenario analysis
- âœ¨ **New**: Code examples in TypeScript, Python, and Rust
- ğŸ“ **Updated**: Mathematical formulas for exposure calculation
- ğŸ’¥ **Breaking**: **Aggregate exposure calculation** considering multiple bet offers and acceptances (not backward compatible)
- ğŸ”§ **Enhanced**: Aggregate exposure logic into bet offer, acceptance, and cancellation workflows
- ğŸ”§ **Enhanced**: Portfolio-aware exposure calculations across all betting operations

### Users API

#### Get Paginated Users Endpoint
- âœ¨ **New**: `meta_*` field filtering support in query parameters
- ğŸ“ **Updated**: Documentation to show how to filter users by metadata fields
- âœ¨ **New**: Examples for meta field filtering using pattern matching
- ğŸ”§ **Enhanced**: Filter by meta keys functionality for advanced user queries

#### User Management - New Endpoints Added
- âœ¨ **New**: **Update User By ID** endpoint (`PATCH /account/user/:userId`)
  - Full PATCH support for updating user information
  - Support for updating name, preferences, and metadata
  - Comprehensive validation and error handling
  - Complete code examples in cURL, JavaScript, Python, and Rust
  
- âœ¨ **New**: **Update User By Reference** endpoint (`PATCH /account/user/:reference/reference`)
  - Alternative update endpoint using user reference instead of ID
  - Same functionality as ID-based update but with reference parameter
  - Matching validation rules and response structure
  - Full multi-language code examples

#### Enhanced Meta Field Support
- ğŸ”§ **Enhanced**: Meta field validation documentation (max 10 fields, string values only)
- âœ¨ **New**: Detailed constraints documentation for meta fields
- ğŸ“ **Updated**: Error response examples for meta field validation failures
- âœ¨ **New**: Examples showing proper meta field key naming (letters, numbers, underscores only)
- âœ¨ **New**: Meta field functionality to users for enhanced user categorization and management

### Transactions API

#### Transaction Improvements
- ğŸ› **Fixed**: Removed `betTrail_id` field from transactions endpoint (deprecated)
- ğŸ“ **Updated**: Documentation updated to reflect betTrail_id removal
- ğŸ”§ **Enhanced**: Transaction description accuracy and clarity

### Accept Bet Offer API

#### Enhanced Acceptance Flow
- âœ¨ **New**: `bet_id` field support to accept bet offer endpoint for direct bet identification
- ğŸ”§ **Enhanced**: More flexible bet acceptance using either `wager_reference` or `bet_id`
- ğŸ”§ **Enhanced**: Streamlined acceptance process with multiple identification options

### Portfolio-Aware Endpoints

#### Outcome Management Updates
- ğŸ”§ **Enhanced**: **Set Bet Active** endpoint to be portfolio-aware
- ğŸ”§ **Enhanced**: **Set Bet Inactive** endpoint to be portfolio-aware  
- ğŸ”§ **Enhanced**: **Force Update Bet Override Outcome** with portfolio awareness
- ğŸ”§ **Enhanced**: **Force Update Wager Outcome** with portfolio awareness
- ğŸ”§ **Enhanced**: Wager outcome and bet override outcome calculations considering full portfolio context
- ğŸ§ª **Testing**: Comprehensive test coverage for portfolio-aware functionality

### General Improvements
- ğŸ“ **Updated**: All field references to use correct naming (`allowed_acceptor_ids` vs `allowed_accepting_user_ids`)
- ğŸ”§ **Enhanced**: Error response documentation across all endpoints
- ğŸ”§ **Enhanced**: Code examples with better error handling and realistic data
- âœ¨ **New**: Proper authorization header documentation references
- ğŸ“ **Updated**: Response format examples across all new endpoints
- ğŸ”§ **Enhanced**: Multi-language code support (cURL, JavaScript, Python, Rust) for all new endpoints

## Technical Notes

- All bet objects now include `allowed_acceptor_ids` field when applicable
- Batch operations are truly atomic - all operations succeed or all fail (limited to 20 requests per batch)
- Meta field filtering uses pattern matching for flexible user queries (`meta_tier`, `meta_status`, etc.)
- **Aggregate exposure calculations** now consider multiple bet offers and acceptances across portfolios
- **Portfolio-aware operations** ensure consistent state management across all betting activities
- User update endpoints support partial updates (only provided fields are modified)
- All new endpoints include comprehensive error handling and validation
- Field naming has been standardized across all documentation
- Transaction descriptions have been improved for better clarity
- Enhanced test coverage ensures reliability of all new features
- Accept Bet Offer endpoint now supports both `wager_reference` and `bet_id` for flexibility

## Breaking Changes

âš ï¸ **Make Bet Offer Endpoint**: No longer accepts `bet_id` field. Use `wager_reference` instead (now required).

âš ï¸ **Cancel Bet Offer Endpoint**: The `wager_reference` field has been replaced with `wager_references` (array). Use the plural form to cancel single or multiple bet offers.

âš ï¸ **Exposure Calculations**: The exposure calculation algorithm has been completely overhauled with aggregate portfolio-aware logic. This change is **not backward compatible** with previous versions. Applications relying on the previous exposure calculation behavior will need to be updated.

---

*This change log documents all updates made to the accounting service API documentation as part of PR #35 implementation.*